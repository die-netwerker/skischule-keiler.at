const o=`{% block sw_users_permissions_role_listing %} <mt-card class="sw-users-permissions-role-listing" position-identifier="sw-users-permissions-role-listing" :title="$tc('sw-users-permissions.roles.general.cardLabel')" > {% block sw_users_permissions_role_listing_toolbar %} <div class="sw-users-permissions-role-listing__toolbar"> <sw-container columns="1fr minmax(100px, 200px)" gap="0 10px" > {% block sw_users_permissions_role_listing_toolbar_search_field %} <sw-simple-search-field v-model:value="term" size="small" variant="form" @search-term-change="onSearch" /> {% endblock %} {% block sw_users_permissions_role_listing_toolbar_add_role_button %} <mt-button ghost size="small" :disabled="!acl.can('users_and_permissions.creator') || undefined" class="sw-users-permissions-role-listing__add-role-button" variant="secondary" @click="$router.push({ name: 'sw.users.permissions.role.detail' })" > {{ $tc('sw-users-permissions.roles.general.labelCreateNewRole') }} </mt-button> {% endblock %} </sw-container> </div> {% endblock %} {% block sw_users_permissions_role_listing_verify_modal %} <sw-verify-user-modal v-if="isConfirmingPasswordModalOpen" @verified="deleteRole" @close="onCloseConfirmPasswordModal" /> {% endblock %} {% block sw_users_permissions_role_listing_grid %} <sw-data-grid v-if="showListingResults" :data-source="roles" :columns="rolesColumns" identifier="roles-grid" :show-settings="true" :show-selection="false" :is-loading="isLoading" @column-sort="onSortColumn" > {% block sw_users_permissions_role_listing_grid_actions %} <template #actions="{ item }"> {% block sw_users_permissions_role_listing_grid_actions_edit %} <sw-context-menu-item :router-link="{ name: 'sw.users.permissions.role.detail', params: { id: item.id } }" class="sw-users-permissions-role-listing__context-menu-edit" :disabled="!acl.can('users_and_permissions.editor') || undefined" > {{ $tc('sw-users-permissions.roles.role-grid.contextMenuEdit') }} </sw-context-menu-item> {% endblock %} {% block sw_users_permissions_role_listing_grid_actions_delete %} <sw-context-menu-item variant="danger" class="sw-users-permissions-role-listing__context-menu-delete" :disabled="!acl.can('users_and_permissions.deleter') || undefined" @click="onDelete(item)" > {{ $tc('sw-users-permissions.roles.role-grid.contextMenuDelete') }} </sw-context-menu-item> {% endblock %} </template> {% endblock %} {% block sw_users_permissions_role_listing_grid_columns %} <template #column-name="{ item }"> {% block sw_users_permissions_role_listing_grid_columns_name %} <router-link :to="{ name: 'sw.users.permissions.role.detail', params: { id: item.id } }"> {{ item.name }} </router-link> {% endblock %} </template> {% endblock %} {% block sw_users_permissions_role_listing_grid_action_modals %} <template #action-modals="{ item }"> {% block sw_users_permissions_role_listing_grid_actions_modals_modal %} <sw-modal v-if="isConfirmDeleteModalOpen" :title="$tc('sw-users-permissions.roles.role-grid.titleModalDelete')" variant="small" @modal-close="onCloseDeleteModal" > {% block sw_users_permissions_role_listing_grid_actions_modals_modal_delete_text %} <p class="sw-users-permissions-role-listing__confirm-delete-text"> {{ $tc('sw-users-permissions.roles.role-grid.textModalDelete', { name: item.name }, 0) }} </p> {% endblock %} {% block sw_users_permissions_role_listing_grid_actions_modals_modal_footer %} <template #modal-footer> {% block sw_users_permissions_role_listing_grid_actions_modals_modal_close_delete %} <mt-button size="small" variant="secondary" @click="onCloseDeleteModal" > {{ $tc('global.default.cancel') }} </mt-button> {% endblock %} {% block sw_users_permissions_role_listing_grid_actions_modals_modal_confirm_delete %} <mt-button class="sw-users-permissions-role-listing__confirm-delete-button" variant="critical" size="small" @click="onConfirmDelete(item)" > {{ $tc('sw-users-permissions.roles.role-grid.labelButtonDelete') }} </mt-button> {% endblock %} </template> {% endblock %} </sw-modal> {% endblock %} </template> {% endblock %} <template #pagination> {% block sw_users_permissions_role_listing_grid_pagination %} <sw-pagination :page="page" :limit="limit" :total="total" :auto-hide="true" @page-change="onPageChange" /> {% endblock %} </template> </sw-data-grid> {% endblock %} {% block sw_users_permissions_role_listing_empty_state %} <sw-empty-state v-else :absolute="false" :title="$tc('sw-users-permissions.roles.role-grid.messageEmptyTitle')" :subline="$tc('sw-users-permissions.roles.role-grid.messageEmptySubline')" /> {% endblock %} </mt-card> {% endblock %}`,{Data:l,Mixin:t}=Shopware,{Criteria:s}=l,r={template:o,inject:["repositoryFactory","acl","ssoSettingsService"],emits:["get-list"],mixins:[t.getByName("listing"),t.getByName("notification")],data(){return{roles:[],isLoading:!1,itemToDelete:null,disableRouteParams:!0,isConfirmDeleteModalOpen:!1,isConfirmingPasswordModalOpen:!1}},computed:{rolesColumns(){return[{property:"name",label:this.$tc("sw-users-permissions.roles.role-grid.labelName")},{property:"description",label:this.$tc("sw-users-permissions.roles.role-grid.labelDescription")}]},roleRepository(){return this.repositoryFactory.create("acl_role")},roleCriteria(){const e=new s(this.page,this.limit);return e.addFilter(s.equals("app.id",null)),e.addFilter(s.equals("deletedAt",null)),this.term&&e.setTerm(this.term),this.sortBy&&e.addSorting(s.sort(this.sortBy,this.sortDirection||"ASC")),e},showListingResults(){return this.isLoading?!1:this.roles&&this.roles.length>0||this.term&&this.term.length<=0}},created(){this.createdComponent()},methods:{createdComponent(){this.$emit("get-list")},getList(){return this.isLoading=!0,this.roles=[],this.roleRepository.search(this.roleCriteria).then(e=>{this.total=e.total,this.roles=e}).finally(()=>{this.isLoading=!1})},onSearch(e){this.term=e,this.$emit("get-list")},getItemToDelete(e){return this.itemToDelete?this.itemToDelete.id===e.id:!1},onDelete(e){this.itemToDelete=e,this.isConfirmDeleteModalOpen=!0},onCloseDeleteModal(){this.isConfirmDeleteModalOpen=!1},onConfirmDelete(){this.isLoading=!0,this.onCloseDeleteModal(),this.ssoSettingsService.isSso().then(e=>{if(this.isLoading=!1,e.isSso){this.deleteRole({...Shopware.Context.api});return}this.isConfirmingPasswordModalOpen=!0})},deleteRole(e){this.isConfirmingPasswordModalOpen=!1;const i=this.itemToDelete;this.itemToDelete=null,this.isLoading=!0,this.roleRepository.delete(i.id,e).then(()=>{this.isLoading=!1,this.createNotificationSuccess({message:this.$tc("sw-users-permissions.roles.role-grid.notification.deleteSuccess.message",{name:i.name},0)}),this.$emit("get-list")}).catch(()=>{this.isLoading=!1,this.createNotificationError({message:this.$tc("sw-users-permissions.roles.role-grid.notification.deleteError.message",{name:i.name},0)})})},onCloseConfirmPasswordModal(){this.isConfirmingPasswordModalOpen=!1}}};export{r as default};
