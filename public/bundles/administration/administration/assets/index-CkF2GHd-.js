const n=`{% block sw_order_document_settings_modal_form_first_row %} <sw-container columns="1fr 1fr 1fr" gap="0 14px" > {% block sw_order_document_settings_modal_form_cancellation_document_number %} <mt-text-field v-model="documentNumber" :label="$tc('sw-order.documentModal.labelDocumentStornoNumber')" /> {% endblock %} {% block sw_order_document_settings_modal_form_document_select_invoice %} <mt-select v-model="documentConfig.custom.invoiceNumber" class="sw-order-document-settings-storno-modal__invoice-select" :label="$tc('sw-order.documentModal.labelInvoiceNumber')" :placeholder="$tc('sw-order.documentModal.selectInvoiceNumber')" :options="invoiceOptions" /> {% endblock %} {% block sw_order_document_settings_modal_form_cancellation_document_date %} <mt-datepicker v-model="documentConfig.documentDate" date-type="date" required hide-hint :label="$tc('sw-order.documentModal.labelDocumentDate')" :placeholder="$tc('sw-datepicker.date.placeholder')" /> {% endblock %} </sw-container> {% endblock %}`,c={template:n,emits:["loading-document","loading-preview"],props:{order:{type:Object,required:!0},currentDocumentType:{type:Object,required:!0}},data(){return{documentConfig:{custom:{stornoNumber:"",invoiceNumber:""},documentNumber:0,documentComment:"",documentDate:""}}},computed:{documentPreconditionsFulfilled(){return!!this.documentConfig.custom.invoiceNumber},invoices(){return this.order.documents.filter(e=>e.documentType.technicalName==="invoice"||e.documentType.technicalName==="zugferd_invoice"||e.documentType.technicalName==="zugferd_embedded_invoice")},documentNumber:{get(){return String(this.documentConfig.documentNumber)},set(e){this.documentConfig.documentNumber=e}},invoiceOptions(){return this.invoices.map((e,o)=>({id:o,value:e.config.custom.invoiceNumber,label:`${e.config.custom.invoiceNumber}`}))}},created(){this.createdComponent()},methods:{createdComponent(){this.numberRangeService.reserve(`document_${this.currentDocumentType.technicalName}`,this.order.salesChannelId,!0).then(e=>{this.documentConfig.documentNumber=e.number,this.documentNumberPreview=this.documentConfig.documentNumber,this.documentConfig.documentDate=new Date().toISOString()})},onCreateDocument(e=!1){this.$emit("loading-document");const o=this.invoices.filter(t=>t.config.custom.invoiceNumber===this.documentConfig.custom.invoiceNumber)[0];this.documentNumberPreview===this.documentConfig.documentNumber?this.numberRangeService.reserve(`document_${this.currentDocumentType.technicalName}`,this.order.salesChannelId,!1).then(t=>{this.documentConfig.custom.stornoNumber=t.number,t.number!==this.documentConfig.documentNumber&&this.createNotificationInfo({message:this.$tc("sw-order.documentCard.info.DOCUMENT__NUMBER_WAS_CHANGED")}),this.documentConfig.documentNumber=t.number,this.callDocumentCreate(e,o.id)}):(this.documentConfig.custom.stornoNumber=this.documentConfig.documentNumber,this.callDocumentCreate(e,o.id))},onPreview(e="pdf"){this.$emit("loading-preview"),this.documentConfig.custom.stornoNumber=this.documentConfig.documentNumber,this.$super("onPreview",e)}}};export{c as default};
