const M=`{% block sw_desktop %} <div class="sw-desktop" :class="desktopClasses" > <div v-if="isStaging" class="sw-staging-bar" > {{ $tc('global.sw-desktop.stagingBarText') }} </div> {% block sw_desktop_sidebar %} <sw-admin-menu v-if="!noNavigation" /> {% endblock %} {% block sw_desktop_content %} <div class="sw-desktop__content"> {% block sw_desktop_content_view %} <sw-error-boundary> <router-view /> </sw-error-boundary> {% endblock %} </div> <sw-app-app-url-changed-modal v-if="urlDiff !== null" :url-diff="urlDiff" @modal-close="closeModal" /> <sw-settings-services-grant-permissions-modal /> {% endblock %} <sw-sidebar-renderer /> </div> {% endblock %}`,{hasOwnProperty:b}=Shopware.Utils.object,$={template:M,inject:["feature","appUrlChangeService","userActivityApiService"],data(){return{noNavigation:!1,urlDiff:null}},computed:{desktopClasses(){return{"sw-desktop--no-nav":this.noNavigation,"sw-desktop--staging":this.isStaging}},currentUser(){return Shopware.Store.get("session").currentUser},isStaging(){var e;return((e=Shopware.Store.get("context").app.config.settings)==null?void 0:e.enableStagingMode)===!0}},watch:{$route(){this.checkRouteSettings()},"$route.name":{handler(e,n){n===void 0||e===n||this.onUpdateSearchFrequently()},immediate:!0}},created(){this.createdComponent()},methods:{createdComponent(){this.checkRouteSettings(),this.updateShowUrlChangedModal()},checkRouteSettings(){this.$route.meta&&b(this.$route.meta,"noNav")?this.noNavigation=this.$route.meta.noNav:this.noNavigation=!1},updateShowUrlChangedModal(){var e;if(!((e=Shopware.Store.get("context").app.config.settings)!=null&&e.appsRequireAppUrl)){this.urlDiff=null;return}this.appUrlChangeService.getUrlDiff().then(n=>{this.urlDiff=n})},closeModal(){this.urlDiff=null},onUpdateSearchFrequently(){var r;const e=this.getModuleMetadata();if(!e||!((r=e==null?void 0:e.route)!=null&&r.name))return!1;const n={key:`${e.name}@${e.route.name}`,cluster:this.currentUser.id};return this.userActivityApiService.increment(n)},getModuleMetadata(){var h,p,g,f,m,v,w;const{$module:e}=this.$route.meta,n=(h=this.$route)==null?void 0:h.name;if(!e)return!1;const{name:r,icon:d,color:a,entity:o,routes:t,title:l}=e;if(!this.$te(l)||!(t!=null&&t.index))return!1;const u=this.getModuleMetadataWithSearchMatcher(e,n);if(u){const{components:i,children:S,meta:s,props:k,...c}=u.route;return{...u,route:c}}if(((p=t==null?void 0:t.index)==null?void 0:p.name)===n||(f=(g=t.index)==null?void 0:g.children)!=null&&f.some(i=>i.name===n)){const{components:i,children:S,meta:s,props:k,...c}=t.index;return{name:r,icon:d,color:a,title:l,entity:o,privilege:s==null?void 0:s.privilege,route:c}}if(((m=t==null?void 0:t.create)==null?void 0:m.name)===n||(w=(v=t.create)==null?void 0:v.children)!=null&&w.some(i=>i.name===n)){const{components:i,children:S,meta:s,props:k,...c}=t.create;return{name:r,icon:d,color:a,entity:o,privilege:s==null?void 0:s.privilege,route:c,action:!0}}return!1},getModuleMetadataWithSearchMatcher(e,n){if(typeof e.searchMatcher!="function")return!1;const{title:r}=e;return e.searchMatcher(new RegExp(`^${this.$tc(r).toLowerCase()}(.*)`),this.$tc(r,2),e).find(a=>{var o,t;return a.route.name===n||((t=(o=a.route)==null?void 0:o.children)==null?void 0:t.some(l=>l.name===n))})}}};export{$ as default};
