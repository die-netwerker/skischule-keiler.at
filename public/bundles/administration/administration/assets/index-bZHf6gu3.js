const s=`{% block sw_sales_channel_menu %} <div class="sw-sales-channel-menu"> {% block sw_sales_channel_menu_modal %} <sw-sales-channel-modal v-if="showModal" @modal-close="showModal=false" /> {% endblock %} {% block sw_sales_channel_menu_headline %} <div class="sw-admin-menu__headline"> {% block sw_sales_channel_menu_headline_text %} <div class="collapsible-text sw-admin-menu__headline_text"> <router-link :to="{ name: 'sw.sales.channel.list' }" >{{ $tc('sw-sales-channel.general.titleMenuItems') }}</router-link> </div> {% endblock %} {% block sw_sales_channel_menu_headline_context_button %} <sw-context-button class="sw-admin-menu__headline-context-menu" icon="solid-ellipsis-h" > {% block sw_sales_channel_menu_headline_context_button_item %} <sw-context-menu-item class="sw-admin-menu__headline-context-menu-manage-sales-channels" :router-link="{ name: 'sw.sales.channel.list' }" > {{ $tc('sw-sales-channel.general.manageSalesChannels') }} </sw-context-menu-item> {% endblock %} </sw-context-button> {% endblock %} {% block sw_sales_channel_menu_headline_action %} <button v-if="canCreateSalesChannels" :aria-label="$tc('sw-sales-channel.general.addSalesChannel')" class="sw-admin-menu__headline-action" @click="openSalesChannelModal" > <mt-icon class="sw-admin-menu__headline-icon" name="regular-plus-circle-s" size="16px" /> </button> {% endblock %} </div> {% endblock %} {% block sw_sales_channel_menu_navigation %} <nav class="sw-admin-menu__navigation"> {% block sw_sales_channel_menu_navigation_main_list %} <ul class="sw-admin-menu__navigation-list"> {% block sw_sales_channel_menu_navigation_main_items %} <sw-admin-menu-item v-for="(entry, index) in buildMenuTree" :key="entry.id || index" class="sw-admin-menu__sales-channel-item" :entry="entry" icon-size="16px" :class="['sw-admin-menu__sales-channel-item--' + index]" > <template #additional-text> {% block sw_sales_channel_menu_navigation_item_additional_text %} <button v-if="entry.domainLink && entry.active" class="sw-sales-channel-menu-domain-link" :title="$tc('sw-sales-channel.general.tooltipOpenStorefront')" @click.prevent="openStorefrontLink(entry.domainLink)" > <mt-icon class="sw-sales-channel-menu-domain-link__icon" name="regular-eye-s" size="16px" /> </button> {% endblock %} </template> </sw-admin-menu-item> {% endblock %} {% block sw_sales_channel_menu_navigation_more_items %} <sw-admin-menu-item v-if="moreSalesChannelAvailable" :entry="moreItemsEntry" class="sw-admin-menu__sales-channel-more-items" icon-size="16px" /> {% endblock %} </ul> {% endblock %} {% block sw_sales_channel_menu_context_button_collapsed %} <sw-context-button class="sw-sales-channel-menu__collapsed-context-menu" icon="regular-ellipsis-v" aria-label="sw-sales-channel.general.manageSalesChannels" icon-size="20px" > <sw-context-menu-item class="sw-admin-menu__headline-context-menu-manage-sales-channels" :router-link="{ name: 'sw.sales.channel.list' }" > {{ $tc('sw-sales-channel.general.manageSalesChannels') }} </sw-context-menu-item> </sw-context-button> {% endblock %} </nav> {% endblock %} </div> {% endblock %}`,{Criteria:a}=Shopware.Data,l=Shopware.Helper.FlatTreeHelper,t={template:s,inject:["repositoryFactory","acl","domainLinkService"],data(){return{salesChannels:[],showModal:!1,isLoading:!0}},computed:{salesChannelRepository(){return this.repositoryFactory.create("sales_channel")},canCreateSalesChannels(){return this.acl.can("sales_channel.creator")},salesChannelCriteria(){const e=new a(1,7);return e.addIncludes({sales_channel:["name","type","active","translated","domains"],sales_channel_type:["iconName"],sales_channel_domain:["url","languageId"]}),e.addSorting(a.sort("sales_channel.name","ASC")),e.addAssociation("type"),e.addAssociation("domains"),this.salesChannelFavorites.length&&(e.setLimit(50),e.addFilter(a.equalsAny("id",this.salesChannelFavorites))),e},moreSalesChannelAvailable(){var e,n;return((e=this.salesChannels)==null?void 0:e.total)>((n=this.salesChannels)==null?void 0:n.length)},buildMenuTree(){const e=new l;return this.salesChannels.forEach(n=>{e.add({id:n.id,path:"sw.sales.channel.detail",params:{id:n.id},color:"#D8DDE6",label:{label:n.translated.name,translated:!0},icon:n.type.iconName,children:[],domainLink:this.getDomainLink(n),active:n.active})}),e.convertToTree()},moreItemsEntry(){return{active:!0,children:[],color:"#D8DDE6",icon:"regular-ellipsis-v",label:this.$tc("sw-sales-channel.general.titleMenuMoreItems"),path:"sw.sales.channel.list",position:-1}},salesChannelFavoritesService(){return Shopware.Service("salesChannelFavorites")},salesChannelFavorites(){return this.isLoading?[]:this.salesChannelFavoritesService.getFavoriteIds()}},watch:{salesChannelFavorites(){this.isLoading||this.loadEntityData()}},created(){this.createdComponent()},unmounted(){this.destroyedComponent()},methods:{createdComponent(){this.registerListener(),this.salesChannelFavoritesService.initService().finally(()=>{this.isLoading=!1})},registerListener(){Shopware.Utils.EventBus.on("sw-sales-channel-detail-sales-channel-change",this.loadEntityData),Shopware.Utils.EventBus.on("sw-language-switch-change-application-language",this.loadEntityData),Shopware.Utils.EventBus.on("sw-sales-channel-detail-base-sales-channel-change",this.openSalesChannelModal),Shopware.Utils.EventBus.on("sw-sales-channel-list-add-new-channel",this.openSalesChannelModal)},destroyedComponent(){Shopware.Utils.EventBus.off("sw-sales-channel-detail-sales-channel-change",this.loadEntityData),Shopware.Utils.EventBus.off("sw-language-switch-change-application-language",this.loadEntityData),Shopware.Utils.EventBus.off("sw-sales-channel-detail-base-sales-channel-change",this.openSalesChannelModal),Shopware.Utils.EventBus.off("sw-sales-channel-list-add-new-channel",this.openSalesChannelModal)},getDomainLink(e){return this.domainLinkService.getDomainLink(e)},loadEntityData(){this.salesChannelRepository.search(this.salesChannelCriteria).then(e=>{this.salesChannels=e})},openSalesChannelModal(){this.showModal=!0},openStorefrontLink(e){window.open(e,"_blank")}}};export{t as default};
