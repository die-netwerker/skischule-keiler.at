const i=`{% block sw_dynamic_url_field %} <div class="sw-dynamic-url-field"> {% block sw_dynamic_url_field_content %} <div class="sw-dynamic-url-field_link-category"> {% block sw_dynamic_url_field_content_type %} <mt-select :model-value="linkCategory" :label="$tc('sw-text-editor-toolbar.link.labelType')" required :options="linkCategoryOptions" @update:model-value="onSelectFieldChange" /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs %} {% block sw_dynamic_url_field_content_type_inputs_link %} <mt-text-field v-if="linkCategory === 'link'" v-model="linkTarget" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :placeholder="$tc('sw-text-editor-toolbar.link.placeholder')" /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs_phone %} <mt-text-field v-else-if="linkCategory === 'phone'" v-model="linkTarget" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :placeholder="$tc('sw-text-editor-toolbar.link.placeholderPhoneNumber')" /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs_email %} <mt-email-field v-else-if="linkCategory === 'email'" v-model="linkTarget" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :placeholder="$tc('sw-text-editor-toolbar.link.placeholderEmail')" /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs_detail %} <sw-entity-single-select v-else-if="linkCategory === 'detail'" v-model:value="linkTarget" class="sw-dynamic-url-field__entity-single-select" should-show-active-state display-variants entity="product" :criteria="entityFilter" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :placeholder="$tc('sw-text-editor-toolbar.link.placeholderProduct')" show-clearable-button /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs_category %} <sw-category-tree-field v-else-if="linkCategory === 'navigation'" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :criteria="entityFilter" :placeholder="$tc('sw-text-editor-toolbar.link.placeholderCategory')" :categories-collection="categoryCollection" single-select @selection-add="replaceCategorySelection" @selection-remove="removeCategorySelection" /> {% endblock %} {% block sw_dynamic_url_field_content_type_inputs_media %} <sw-media-field v-else-if="linkCategory === 'media'" v-model:value="linkTarget" :label="$tc('sw-text-editor-toolbar.link.linkTo')" :criteria="entityFilter" single-select /> {% endblock %} {% endblock %} </div> {% endblock %} {% block sw_dynamic_url_field_button_remove %} <mt-button class="sw-dynamic-url-field__link-menu-buttons-button-remove" variant="critical" ghost size="small" :disabled="!linkTarget" @click="removeLink" > {{ $tc('global.default.remove') }} </mt-button> {% endblock %} </div> {% endblock %}`,{Criteria:l,EntityCollection:a}=Shopware.Data,o=Shopware.Component.wrapComponentConfig({template:i,inject:["repositoryFactory"],props:{value:{type:String,required:!1,default:""}},data(){return{lastEmittedLink:"",linkTarget:"",isHTTPs:!1,displayAsButton:!1,linkCategory:"link",categoryCollection:void 0}},computed:{seoUrlReplacePrefix(){return"124c71d524604ccbad6042edce3ac799"},entityFilter(){const e=new l(1,25);return e.addAssociation("options.group"),e.addFilter(l.multi("OR",[l.equals("product.childCount",0),l.equals("product.childCount",null)])),e},categoryRepository(){return this.repositoryFactory.create("category")},linkCategoryOptions(){return[{value:"link",label:this.$tc("sw-text-editor-toolbar.link.labelUrl")},{value:"detail",label:this.$tc("sw-text-editor-toolbar.link.labelProduct")},{value:"navigation",label:this.$tc("sw-text-editor-toolbar.link.labelCategory")},{value:"media",label:this.$tc("sw-text-editor-toolbar.link.labelMedia")},{value:"email",label:this.$tc("sw-text-editor-toolbar.link.labelEmail")},{value:"phone",label:this.$tc("sw-text-editor-toolbar.link.labelPhoneNumber")}]}},watch:{value:{async handler(e){if(e===this.lastEmittedLink||typeof e!="string")return;const t=await this.parseLink(e);this.linkCategory=t.type,this.linkTarget=t.target},immediate:!0},linkTarget:{handler(){const e=this.prepareLink();e!==this.value&&(this.lastEmittedLink=e,this.$emit("update:value",e))}}},created(){this.createdComponent()},methods:{createdComponent(){this.categoryCollection=this.getEmptyCategoryCollection()},getEmptyCategoryCollection(){return new a(this.categoryRepository.route,this.categoryRepository.entityName,Shopware.Context.api)},getCategoryCollection(e){const t=new l(1,25).addFilter(l.equals("id",e));return this.categoryRepository.search(t)},async parseLink(e){const t=e.slice(0,-1).split("/");return e.startsWith(this.seoUrlReplacePrefix)&&["navigation","detail","mediaId"].includes(t[1])?(t[1]==="navigation"?this.categoryCollection=await this.getCategoryCollection(t[2]):t[1]==="mediaId"&&(t[1]="media"),{type:t[1],target:t[2]}):e.startsWith("mailto:")?{type:"email",target:e.replace("mailto:","")}:e.startsWith("tel:")?{type:"phone",target:e.replace("tel:","")}:{type:"link",target:e}},replaceCategorySelection(e){this.linkTarget=e.id},removeCategorySelection(){this.linkTarget=""},prepareLink(){if(!this.linkTarget)return"";switch(this.linkCategory){case"detail":return`${this.seoUrlReplacePrefix}/detail/${this.linkTarget}#`;case"navigation":return`${this.seoUrlReplacePrefix}/navigation/${this.linkTarget}#`;case"media":return`${this.seoUrlReplacePrefix}/mediaId/${this.linkTarget}#`;case"email":return`mailto:${this.linkTarget}`;case"phone":return`tel:${this.linkTarget.replace(/\//,"")}`;default:return this.linkTarget}},removeLink(){this.linkTarget=""},onSelectFieldChange(e){this.linkTarget="",this.linkCategory=e}}});export{o as default};
