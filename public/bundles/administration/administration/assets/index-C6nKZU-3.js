const p=`{% block sw_import_export_view_profile %} <div class="sw-import-export-view-profiles"> {% block sw_import_export_view_profile_profiles %} <mt-card :title="$tc('sw-import-export.page.profileTab')" class="sw-import-export-view-profiles__grid-card" position-identifier="sw-import-export-view-profiles" > {% block sw_import_export_view_profile_profiles_toolbar %} <div class="sw-import-export-view-profiles__toolbar"> {% block sw_import_export_view_profile_profiles_toolbar_search_field %} <sw-simple-search-field v-model:value="searchTerm" class="sw-import-export-view-profiles__search" size="small" variant="form" @search-term-change="onSearch" /> {% endblock %} {% block sw_import_export_view_profile_profiles_toolbar_add_new_profile %} <mt-button v-tooltip="createTooltip" class="sw-import-export-view-profiles__create-action" ghost :disabled="isLoading || isNotSystemLanguage" size="small" variant="secondary" @click="onAddNewProfile" > {{ $tc('sw-import-export.profile.addNewProfileLabel') }} </mt-button> {% endblock %} </div> {% endblock %} {% block sw_import_export_view_profile_profiles_listing %} <sw-entity-listing ref="listing" class="sw-import-export-view-profiles__listing" :repository="profileRepository" :items="profiles" :is-loading="isLoading" :columns="profilesColumns" :sort-by="sortBy" :sort-direction="sortDirection" :show-settings="false" :show-selection="true" :allow-column-edit="false" :full-page="false" :plain-appearance="true" > {# @deprecated tag:v6.8.0 - Block will be removed. #} {% block sw_import_export_view_profile_profiles_listing_column_label %} {% endblock %} <template #column-technicalName="{ item }"> <a href="#" @click.prevent="onEditProfile(item.id)" > {{ item.technicalName }} </a> </template> {% block sw_import_export_view_profile_profiles_listing_column_system_default %} <template #column-systemDefault="{ item }"> {{ getTypeLabel(item.systemDefault) }} </template> {% endblock %} <template #actions="{ item }"> {% block sw_import_export_view_profile_profiles_listing_edit %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-open-action" @click="onEditProfile(item.id)" > {{ $tc('sw-import-export.profile.openLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_duplicate %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-duplicate-action" @click="onDuplicateProfile(item)" > {{ $tc('sw-import-export.profile.duplicateLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_download_template %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-download-template-action" @click="onDownloadTemplate(item)" > {{ $tc('sw-import-export.profile.downloadTemplateLabel') }} </sw-context-menu-item> {% endblock %} {% block sw_import_export_view_profile_profiles_listing_delete %} <sw-context-menu-item class="sw-import-export-view-profiles__listing-delete-action" variant="danger" :disabled="item.systemDefault" @click="onDeleteProfile(item.id)" > {{ $tc('sw-import-export.profile.deleteLabel') }} </sw-context-menu-item> {% endblock %} </template> </sw-entity-listing> {% endblock %} </mt-card> {% endblock %} {% block sw_import_export_view_profile_modal %} <sw-import-export-edit-profile-modal :show="showProfileEditModal" :profile="selectedProfile" @profile-save="saveSelectedProfile" @profile-close="closeSelectedProfile" /> {% endblock %} {% block sw_import_export_view_new_profile_wizard %} <sw-import-export-new-profile-wizard v-if="showNewProfileWizard" :profile="selectedProfile" @profile-save="saveSelectedProfile" @close="onCloseNewProfileWizard" /> {% endblock %} </div> {% endblock %}`,{Mixin:n}=Shopware,{Criteria:s}=Shopware.Data,c={template:p,inject:["repositoryFactory","importExport","feature"],mixins:[n.getByName("notification")],data(){return{isLoading:!1,selectedProfile:null,profiles:null,searchTerm:null,sortBy:"technicalName",sortDirection:"ASC",showProfileEditModal:!1,showNewProfileWizard:!1}},metaInfo(){return{title:this.$createTitle()}},computed:{profileRepository(){return this.repositoryFactory.create("import_export_profile")},profileCriteria(){return new s(1,25).setTerm(this.searchTerm).addAssociation("importExportLogs").addSorting(s.sort(this.sortBy,this.sortDirection))},profilesColumns(){return[{property:"technicalName",dataIndex:"technicalName",label:"sw-import-export.profile.technicalNameColumn",allowResize:!0,primary:!0},{property:"systemDefault",dataIndex:"systemDefault",label:"sw-import-export.profile.typeColumn",allowResize:!0}]},isNotSystemLanguage(){return Shopware.Context.api.systemLanguageId!==Shopware.Context.api.languageId},createTooltip(){return{showDelay:300,message:this.$tc("sw-import-export.profile.addNewProfileTooltipLanguage"),disabled:!this.isNotSystemLanguage}}},created(){this.createdComponent()},methods:{createdComponent(){this.loadProfiles()},async loadProfiles(){this.isLoading=!0,this.profiles=await this.profileRepository.search(this.profileCriteria),this.isLoading=!1},reloadContent(){this.loadProfiles()},onSearch(){this.loadProfiles()},onAddNewProfile(){const e={...this.profileRepository.create(),fileType:"text/csv",mapping:[],config:{createEntities:!0,updateEntities:!0},type:"import-export",translated:{},delimiter:";",enclosure:'"'};this.selectedProfile=null,this.selectedProfile=e,this.showNewProfileWizard=!0},async onEditProfile(e){var o,i;const t=await this.profileRepository.get(e);Array.isArray(t.config)&&t.config.length<=0&&(this.profile.config={}),((o=t.config)==null?void 0:o.createEntities)===void 0&&(t.config.createEntities=!0),((i=t.config)==null?void 0:i.updateEntities)===void 0&&(t.config.updateEntities=!0),this.selectedProfile=t,this.showProfileEditModal=!0},onDuplicateProfile(e){const t={cloneChildren:!1,overwrites:{technicalName:`${e.technicalName}-copy-${Date.now()}`,systemDefault:!1}};return this.profileRepository.clone(e.id,t,Shopware.Context.api).then(o=>{const i=new s(1,25).setIds([o.id]);return this.profileRepository.search(i)}).then(o=>{var r,l;const i=o[0];return((r=i.config)==null?void 0:r.createEntities)===void 0&&(i.config.createEntities=!0),((l=i.config)==null?void 0:l.updateEntities)===void 0&&(i.config.updateEntities=!0),this.selectedProfile=i,this.showProfileEditModal=!0,this.loadProfiles()}).catch(()=>{this.createNotificationError({message:this.$tc("global.notification.unspecifiedSaveErrorMessage")})})},async onDownloadTemplate(e){return window.open(await this.importExport.getTemplateFileDownloadUrl(e.id),"_blank")},onDeleteProfile(e){this.$refs.listing.showDelete(e)},closeSelectedProfile(){this.showProfileEditModal=!1,this.selectedProfile=null},saveSelectedProfile(){return this.isLoading=!0,this.profileRepository.save(this.selectedProfile,Shopware.Context.api).then(()=>(this.showProfileEditModal=!1,this.selectedProfile=null,this.onCloseNewProfileWizard(),this.createNotificationSuccess({message:this.$tc("sw-import-export.profile.messageSaveSuccess",0)}),this.loadProfiles())).catch(e=>{this.onError(e)}).finally(()=>{this.isLoading=!1})},onError(e){var i,r,l,a;const t=((a=(l=(r=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:r.errors)==null?void 0:l[0])==null?void 0:a.code)??null;let o="";t!==null&&this.$te(`sw-import-export.errors.${t}`)&&(o=this.$tc(`sw-import-export.errors.${t}`)),this.createNotificationError({message:`${this.$tc("sw-import-export.profile.messageSaveError",0)} ${o}`})},getTypeLabel(e){return e?this.$tc("sw-import-export.profile.defaultTypeLabel"):this.$tc("sw-import-export.profile.customTypeLabel")},onCloseNewProfileWizard(){this.showNewProfileWizard=!1,this.selectedProfile=null}}};export{c as default};
