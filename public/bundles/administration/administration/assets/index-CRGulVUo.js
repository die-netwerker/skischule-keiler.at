const m=`{% block sw_cms_element_image_gallery_config %} <div class="sw-cms-el-config-image-gallery"> {% block sw_cms_element_image_gallery_config_tabs %} <sw-tabs position-identifier="sw-cms-element-config-image-gallery" class="sw-cms-el-config-image-gallery__tabs" default-item="content" > <template #default="{ active }"> {% block sw_cms_element_image_gallery_config_tab_content %} <sw-tabs-item :title="$tc('sw-cms.elements.general.config.tab.content')" name="content" :active-tab="active" > {{ $tc('sw-cms.elements.general.config.tab.content') }} </sw-tabs-item> {% endblock %} {% block sw_cms_element_image_gallery_config_tab_options %} <sw-tabs-item :title="$tc('sw-cms.elements.general.config.tab.settings')" name="settings" :active-tab="active" > {{ $tc('sw-cms.elements.general.config.tab.settings') }} </sw-tabs-item> {% endblock %} </template> <template #content="{ active }" > {% block sw_cms_element_image_gallery_config_content %} <sw-container v-if="active === 'content'" class="sw-cms-el-config-image-gallery__tab-content" > {% block sw_cms_element_image_gallery_config_media_selection %} <sw-cms-mapping-field v-model:config="element.config.sliderItems" entity="product_media" value-types="entity" :label="$tc('sw-cms.elements.imageGallery.label')" > {% block sw_cms_element_image_gallery_config_media_list_selection %} <sw-media-list-selection-v2 :entity-media-items="mediaItems" :entity="entity" :upload-tag="uploadTag" :default-folder="defaultFolderName" @upload-finish="onImageUpload" @item-remove="onItemRemove" @open-sidebar="onOpenMediaModal" @item-sort="onItemSort" /> {% endblock %} {% block sw_cms_element_image_gallery_config_media_mapping_preview %} <template #preview="{ demoValue }"> {% block sw_cms_element_image_gallery_config_media_preview_list %} <div v-if="demoValue && demoValue.length" ref="demoMediaGrid" class="sw-cms-el-config-image-gallery__mapping-preview" :style="gridAutoRows" > {% block sw_cms_element_image_gallery_config_media_preview_item %} <div v-for="demo in demoValue" :key="demo.id" class="sw-cms-el-config-image-gallery__preview-image" > <img :src="demo.media.url" alt="" > </div> {% endblock %} </div> {% endblock %} {% block sw_cms_element_image_gallery_config_media_preview_info %} <mt-banner v-else class="sw-cms-el-config-image__preview-info" variant="info" > {{ $tc('sw-cms.detail.label.mappingEmptyPreview') }} </mt-banner> {% endblock %} </template> {% endblock %} </sw-cms-mapping-field> {% endblock %} {% block sw_cms_element_image_gallery_config_media_modal %} <sw-media-modal-v2 v-if="mediaModalIsOpen" variant="full" :caption="$tc('sw-cms.elements.general.config.caption.mediaUpload')" :entity-context="cmsPageState.entityName" :initial-folder-id="cmsPageState.defaultMediaFolderId" @media-upload-remove-image="onItemRemove" @media-modal-selection-change="onMediaSelectionChange" @modal-close="onCloseMediaModal" /> {% endblock %} </sw-container> {% endblock %} {% block sw_cms_element_image_gallery_config_settings %} <sw-container v-if="active === 'settings'" class="sw-cms-el-config-image-gallery__tab-settings" > <div class="sw-cms-el-config-image-gallery__settings-options"> {% block sw_cms_element_image_gallery_config_settings_display_mode %} <div class="sw-cms-el-config-image-gallery__setting-option"> {% block sw_cms_element_image_gallery_config_settings_display_mode_select %} <mt-select v-model="element.config.displayMode.value" class="sw-cms-el-config-image-gallery__setting-display-mode" :label="$tc('sw-cms.elements.general.config.label.displayMode')" :help-text="$tc('sw-cms.elements.imageGallery.config.helpText.displayMode')" :options="displayModeValueOptions" @update:model-value="onChangeDisplayMode" /> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_min_height %} <mt-text-field v-model="element.config.minHeight.value" :label="$tc('sw-cms.elements.image.config.label.minHeight')" :placeholder="$tc('sw-cms.elements.image.config.placeholder.enterMinHeight')" :help-text="$tc('sw-cms.elements.image.config.label.minHeightHelpText')" :disabled="!['cover', 'contain'].includes(element.config.displayMode.value)" @update:model-value="onChangeMinHeight" /> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_vertical_align %} {# ToDo NEXT-38801 - Re-enable and fix broken vertical align #} <mt-select v-if="false" v-model="element.config.verticalAlign.value" :label="$tc('sw-cms.elements.general.config.label.verticalAlign')" :placeholder="$tc('sw-cms.elements.general.config.label.verticalAlign')" :disabled="['cover', 'contain'].includes(element.config.displayMode.value)" :options="verticalAlignValueOptions" /> {% endblock %} </div> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_navigation %} <div class="sw-cms-el-config-image-gallery__setting-navigations sw-cms-el-config-image-gallery__setting-option"> <div class="sw-cms-el-config-image-gallery__settings-navigation"> {% block sw_cms_element_image_gallery_config_settings_navigation_arrow_position %} <mt-select v-model="element.config.navigationArrows.value" :label="$tc('sw-cms.elements.imageSlider.config.label.navigationArrows')" :options="navigationArrowsValueOptions" @update:model-value="emitUpdateEl" /> {% endblock %} </div> <div class="sw-cms-el-config-image-gallery__settings-navigation"> {% block sw_cms_element_image_gallery_config_settings_navigation_dots_position %} <mt-select v-model="element.config.navigationDots.value" :label="$tc('sw-cms.elements.imageSlider.config.label.navigationDots')" :options="navigationDotsValueOptions" @update:model-value="emitUpdateEl" /> {% endblock %} </div> <div class="sw-cms-el-config-image-gallery__settings-navigation"> {% block sw_cms_element_image_gallery_config_settings_navigation_preview_position %} <mt-select v-model="element.config.galleryPosition.value" :label="$tc('sw-cms.elements.imageGallery.config.label.navigationPreview')" :options="galleryPositionValueOptions" @update:model-value="emitUpdateEl" /> {% endblock %} </div> </div> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_zoom_toggles %} <div class="sw-cms-el-config-image-gallery__setting-option"> {% block sw_cms_element_image_gallery_config_settings_toggle_zoom %} <mt-switch v-model="element.config.zoom.value" bordered :label="$tc('sw-cms.elements.imageGallery.config.label.zoom')" /> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_toggle_fullscreen %} <mt-switch v-model="element.config.fullScreen.value" bordered :label="$tc('sw-cms.elements.imageGallery.config.label.fullscreen')" /> {% endblock %} </div> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_aspect_ratio_magnifier_over_gallery_toggles %} <div class="sw-cms-el-config-image-gallery__setting-option"> {% block sw_cms_element_image_gallery_config_settings_toggle_keep_aspect_ratio_on_zoom %} <mt-switch v-model="element.config.keepAspectRatioOnZoom.value" bordered :label="$tc('sw-cms.elements.imageGallery.config.label.keepAspectRatioOnZoom')" /> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_toggle_magnifier_over_gallery %} <mt-switch v-model="element.config.magnifierOverGallery.value" bordered :label="$tc('sw-cms.elements.imageGallery.config.label.magnifierOverGallery')" :help-text="$tc('sw-cms.elements.imageGallery.config.label.magnifierOverGalleryHelpText')" /> {% endblock %} {% block sw_cms_element_image_gallery_config_settings_use_fetch_priority_on_first_item %} <mt-switch class="sw-cms-el-config-image-gallery__settings-use-fetch-priority-on-first-item" :model-value="element.config.useFetchPriorityOnFirstItem.value" :label="$t('sw-cms.elements.image.config.label.useFetchPriorityOnFirstItem')" :help-text="$t('sw-cms.elements.image.config.label.useFetchPriorityOnFirstItemHelpText')" bordered @update:model-value="onChangeUseFetchPriorityOnFirstItem" /> {% endblock %} </div> {% endblock %} </div> </sw-container> {% endblock %} </template> </sw-tabs> {% endblock %} </div> {% endblock %}`,{Mixin:c}=Shopware,{moveItem:o,object:{cloneDeep:g}}=Shopware.Utils,d=Shopware.Data.Criteria,r={template:m,inject:["repositoryFactory","feature"],emits:["element-update"],mixins:[c.getByName("cms-element")],data(){return{mediaModalIsOpen:!1,initialFolderId:null,entity:this.element,mediaItems:[],columnWidth:"100px"}},computed:{mediaRepository(){return this.repositoryFactory.create("media")},uploadTag(){return`cms-element-media-config-${this.element.id}`},defaultFolderName(){return this.cmsPageState._entityName},sliderItems(){return this.element.data&&this.element.data.sliderItems&&this.element.data.sliderItems.length>0?this.element.data.sliderItems:[]},sliderItemsConfigValue(){var e,t,i;return(i=(t=(e=this.element)==null?void 0:e.config)==null?void 0:t.sliderItems)==null?void 0:i.value},gridAutoRows(){return`grid-auto-rows: ${this.columnWidth}`},isProductPage(){var e,t;return(((t=(e=this.cmsPageState)==null?void 0:e.currentPage)==null?void 0:t.type)??"")==="product_detail"},displayModeValueOptions(){return[{value:"standard",label:this.$tc("sw-cms.elements.general.config.label.displayModeStandard")},{value:"contain",label:this.$tc("sw-cms.elements.general.config.label.displayModeContain")},{value:"cover",label:this.$tc("sw-cms.elements.general.config.label.displayModeCover")}]},verticalAlignValueOptions(){return[{value:"flex-start",label:this.$tc("sw-cms.elements.general.config.label.verticalAlignTop")},{value:"center",label:this.$tc("sw-cms.elements.general.config.label.verticalAlignCenter")},{value:"flex-end",label:this.$tc("sw-cms.elements.general.config.label.verticalAlignBottom")}]},navigationArrowsValueOptions(){return[{value:"none",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionNone")},{value:"inside",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionInside")},{value:"outside",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionOutside")}]},navigationDotsValueOptions(){return[{value:"none",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionNone")},{value:"inside",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionInside")},{value:"outside",label:this.$tc("sw-cms.elements.imageSlider.config.label.navigationPositionOutside")}]},galleryPositionValueOptions(){return[{value:"left",label:this.$tc("sw-cms.elements.imageGallery.config.label.navigationPreviewPositionLeft")},{value:"underneath",label:this.$tc("sw-cms.elements.imageGallery.config.label.navigationPreviewPositionUnderneath")}]}},watch:{sliderItems(){this.updateColumnWidth()},sliderItemsConfigValue(e){var l,s,a;if(!e){this.element.config.sliderItems.value=[];return}const t=((a=(s=(l=this.element)==null?void 0:l.config)==null?void 0:s.sliderItems)==null?void 0:a.source)==="mapped",i=e&&e.length===this.sliderItems.length;t||i||!this.sliderItems.length||(this.mediaItems=this.sliderItems.map(n=>n.media),this.element.config.sliderItems.value=this.sliderItems.map(n=>({mediaId:n.media.id,mediaUrl:n.media.url,newTab:n.newTab,url:n.url})))}},created(){this.createdComponent()},mounted(){this.mountedComponent()},methods:{async createdComponent(){this.initElementConfig("image-gallery");const{source:e,value:t}=this.element.config.sliderItems;if(e==="static"&&t&&t.length>0){const i=t.map(a=>a.mediaId),l=new d(1,25);l.setIds(i);const s=await this.mediaRepository.search(l);this.mediaItems=i.map(a=>s.get(a))}this.initConfig()},mountedComponent(){this.updateColumnWidth()},initConfig(){var e,t,i,l;!this.isProductPage||(t=(e=this.element)==null?void 0:e.translated)!=null&&t.config||(l=(i=this.element)==null?void 0:i.data)!=null&&l.sliderItems||(this.element.config.sliderItems.source="mapped",this.element.config.sliderItems.value="product.media",this.element.config.navigationDots.value="inside",this.element.config.zoom.value=!0,this.element.config.fullScreen.value=!0,this.element.config.keepAspectRatioOnZoom.value=!0,this.element.config.magnifierOverGallery.value=!1,this.element.config.displayMode.value="contain",this.element.config.minHeight.value="430px")},updateColumnWidth(){this.$refs.demoMediaGrid&&this.$nextTick(()=>{const e=window.getComputedStyle(this.$refs.demoMediaGrid,null).getPropertyValue("grid-template-columns").split(" ");this.columnWidth=e[0]})},onOpenMediaModal(){this.mediaModalIsOpen=!0},onCloseMediaModal(){this.mediaModalIsOpen=!1},onImageUpload(e){const t=this.element.config.sliderItems;t.source==="default"&&(t.value=[],t.source="static",this.mediaItems=[]),this.mediaItems.find(l=>l.id===e.id)&&(this.mediaItems=this.mediaItems.filter(l=>l.id!==e.id),t.value=t.value.filter(l=>l.mediaId!==e.id)),t.value.push({mediaUrl:e.url,mediaId:e.id,url:null,newTab:!1}),this.mediaItems.push(e),this.updateMediaDataValue(),this.emitUpdateEl()},onItemRemove(e,t){const i=e.id;this.element.config.sliderItems.value=this.element.config.sliderItems.value.filter((l,s)=>l.mediaId!==i||s!==t),this.mediaItems=this.mediaItems.filter((l,s)=>l.id!==i||s!==t),this.updateMediaDataValue(),this.emitUpdateEl()},onMediaSelectionChange(e){const t=this.element.config.sliderItems;t.source==="default"&&(t.value=[],t.source="static",this.mediaItems=[]),e.forEach(i=>{this.element.config.sliderItems.value.push({mediaUrl:i.url,mediaId:i.id,url:null,newTab:!1})}),this.mediaItems.push(...e),this.updateMediaDataValue(),this.emitUpdateEl()},updateMediaDataValue(){if(this.element.config.sliderItems.value){const e=g(this.element.config.sliderItems.value);e.forEach(t=>{this.mediaItems.forEach(i=>{t.mediaId===i.id&&(t.media=i)})}),this.element.data?this.element.data.sliderItems=e:this.element.data={sliderItems:e}}},onItemSort(e,t){o(this.mediaItems,e.position,t.position),o(this.element.config.sliderItems.value,e.position,t.position),this.updateMediaDataValue(),this.emitUpdateEl()},onChangeMinHeight(e){this.element.config.minHeight.value=e===null?"":e,this.$emit("element-update",this.element)},onChangeDisplayMode(e){["cover","contain"].includes(e)&&(this.element.config.verticalAlign.value=null),this.$emit("element-update",this.element)},onChangeUseFetchPriorityOnFirstItem(e){this.element.config.useFetchPriorityOnFirstItem.value=e,this.$emit("element-update",this.element)},emitUpdateEl(){this.$emit("element-update",this.element)}}};export{r as default};
