import{a as m,D as n}from"./promotion.helper-Dhj15HBS.js";import"./channel-D6fkBpuJ.js";const d=`{% block sw_order_create_promotion_modal %} <sw-modal :title="$tc('sw-order.promotionModal.labelTitle')" class="sw-order-create-promotion-modal" @modal-close="onCancel" > {% block sw_order_create_promotion_modal_body %} {% block sw_order_create_promotion_modal_message %} <p>{{ hasNoAutomaticPromotions ? $tc('sw-order.promotionModal.messageNoItems') : $tc('sw-order.promotionModal.message') }}</p> {% endblock %} {% block sw_order_create_promotion_modal_promotions %} <div v-for="(item, index) in cartAutomaticPromotionItems" :key="index" class="sw-order-create-promotion-modal__promotion" > {% block sw_order_create_promotion_modal_promotion_name %} <strong class="sw-order-create-promotion-modal__promotion-name">{{ item.label }}</strong> {% endblock %} {% block sw_order_create_promotion_modal_promotion_description %} <p>{{ getDescription(item) }}</p> {% endblock %} </div> {% endblock %} {% endblock %} {% block sw_order_create_promotion_modal_footer %} <template #modal-footer> {% block sw_order_create_promotion_modal_footer_button_cancel %} <mt-button size="small" variant="secondary" @click="onCancel" > {{ $tc('global.default.cancel') }} </mt-button> {% endblock %} {% block sw_order_create_promotion_modal_footer_button_save %} <mt-button size="small" variant="primary" :is-loading="isLoading" :disabled="hasNoAutomaticPromotions" @click="onSave" > {{ $tc('sw-order.promotionModal.buttonDisable') }} </mt-button> {% endblock %} </template> {% endblock %} </sw-modal> {% endblock %}`,{Store:p,Utils:_,Service:u}=Shopware,{format:r}=_,k={template:d,emits:["close","save"],props:{currency:{type:Object,required:!0},salesChannelId:{type:String,required:!1,default:null}},data(){return{isLoading:!1}},computed:{cart(){return p.get("swOrder").cart},cartAutomaticPromotionItems(){return this.cart.lineItems.filter(o=>o.type==="promotion"&&o.payload.code==="")},hasNoAutomaticPromotions(){return this.cartAutomaticPromotionItems.length===0}},methods:{onCancel(){this.$emit("close")},onSave(){this.disableAutomaticPromotions()},disableAutomaticPromotions(){this.isLoading=!0;const o={salesChannelId:this.salesChannelId};u("cartStoreService").disableAutomaticPromotions(this.cart.token,o).then(()=>{this.isLoading=!1,this.$emit("save")})},getDescription(o){const{totalPrice:a}=o.price,{value:t,discountScope:s,discountType:e,groupId:c}=o.payload,i=`sw-order.createBase.textPromotionDescription.${s}`;if(s===m.CART&&e===n.ABSOLUTE&&Math.abs(a)<t)return this.$tc(`${i}.absoluteUpto`,0,{value:r.currency(Number(t),this.currency.isoCode),totalPrice:r.currency(Math.abs(a),this.currency.isoCode)});const l=e===n.PERCENTAGE?t:r.currency(Number(t),this.currency.isoCode);return this.$tc(`${i}.${e}`,0,{value:l,groupId:c})}}};export{k as default};
